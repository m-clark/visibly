<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Visualize a correlation matrix — corr_heat • visibly!</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Visualize a correlation matrix — corr_heat" />
<meta property="og:description" content="Visualize a correlation matrix" />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">visibly!</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.2.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../reference/index.html">Reference</a>
</li>
<li>
  <a href="../news/index.html">News</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/intro.html">Introduction to visibly</a>
    </li>
    <li>
      <a href="../articles/intro.html##palettes-themes">Palettes &amp; Themes</a>
    </li>
    <li>
      <a href="../articles/intro.html#descriptive-visualization">Descriptive visualization</a>
    </li>
    <li>
      <a href="../articles/intro.html#plotting-model-results">Plot Models</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/m-clark">
    <span class="fa fa-github-alt"></span>
     
  </a>
</li>
<li>
  <a href="https://m-clark.github.io">
    <span class="fa fa-empire"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Visualize a correlation matrix</h1>
    <small class="dont-index">Source: <a href='https://github.com/m-clark/visibly/blob/master/R/corr_heat.R'><code>R/corr_heat.R</code></a></small>
    <div class="hidden name"><code>corr_heat.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Visualize a correlation matrix</p>
    </div>

    <pre class="usage"><span class='fu'>corr_heat</span><span class='op'>(</span>
  <span class='va'>cormat</span>,
  n_factors <span class='op'>=</span> <span class='cn'>NULL</span>,
  psych_opts <span class='op'>=</span> <span class='cn'>NULL</span>,
  ordering <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/c.html'>c</a></span><span class='op'>(</span><span class='st'>"fa"</span>, <span class='st'>"raw"</span>, <span class='st'>"absolute"</span>, <span class='st'>"first"</span>, <span class='st'>"polar"</span><span class='op'>)</span>,
  three_d <span class='op'>=</span> <span class='cn'>FALSE</span>,
  diagonal <span class='op'>=</span> <span class='fl'>1</span>,
  dir <span class='op'>=</span> <span class='op'>-</span><span class='fl'>1</span>,
  pal <span class='op'>=</span> <span class='st'>"vik"</span>,
  plot_only <span class='op'>=</span> <span class='cn'>FALSE</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>cormat</th>
      <td><p>A correlation matrix</p></td>
    </tr>
    <tr>
      <th>n_factors</th>
      <td><p>The number of factors for the factor analysis. Default is
NULL.</p></td>
    </tr>
    <tr>
      <th>psych_opts</th>
      <td><p>a list of arguments to pass to <code><a href='https://rdrr.io/pkg/psych/man/fa.html'>psych::fa</a></code>.</p></td>
    </tr>
    <tr>
      <th>ordering</th>
      <td><p>Order of the result. See details</p></td>
    </tr>
    <tr>
      <th>three_d</th>
      <td><p>Return a surface plot.</p></td>
    </tr>
    <tr>
      <th>diagonal</th>
      <td><p>Value for the diagonal. Must be 1 (default), 0, or NA.</p></td>
    </tr>
    <tr>
      <th>dir</th>
      <td><p>Passed to <a href='https://rdrr.io/pkg/scico/man/scico.html'>scico</a>.</p></td>
    </tr>
    <tr>
      <th>pal</th>
      <td><p>Passed to <a href='https://rdrr.io/pkg/scico/man/scico.html'>scico</a>.</p></td>
    </tr>
    <tr>
      <th>plot_only</th>
      <td><p>Don't run the factor analysis and just return the heatmap.
Default is FALSE.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A plotly object</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>Correlation matrices are typically better visualized rather than parsed
numerically, and while one can do so with various packages at this point,
they either don't reorder the data, don't show the actual values, or only
order based on cluster analysis, and one often may not want the cluster
based approach to ordering if dealing with a correlation matrix, which may
be too small column-wise to be useful for a cluster analysis, or may be a
specific type of data more amenable to a measurement error approach (e.g.
items from a particular scale).</p>
<p>The default <code>corrheat</code> visualization produces a color-coded heatmap in
which Blue represents positive, and Red, negative correlations (the 'vik'
palette), and fades to white the smaller the values are. It is interactive,
such that one can hover over the image to obtain the correlation value.</p>
<p>The ordering is based on the results of a factor analysis
from the <a href='https://rdrr.io/pkg/psych/man/00.psych-package.html'>psych</a> package (which is required). It can be based
on <code><a href='https://rdrr.io/pkg/psych/man/fa.sort.html'>fa.sort</a></code> (default), max raw ("raw") loading,
absolute ("absolute") values of the loadings, loadings of the first factor
only ('first'), or polar coordinates (see <a href='https://rdrr.io/pkg/psych/man/polar.html'>polar</a> ) across all
factors.</p>
<p>By default, the number of factors is chosen to more likely 'just work' for
visualization purposes.  If the number of columns is three or fewer, it
will force only one factor, otherwise it will be
<code><a href='https://rdrr.io/r/base/Round.html'>floor(sqrt(ncol(x)))</a></code>).  While you may supply the number of factors,
as well as other options to the <a href='https://rdrr.io/pkg/psych/man/fa.html'>fa</a> function via
<code>psych_opts</code>, if you want to explore a factor analysis you should you
probably do that separately. In addition, factor analysis can't fix a
poorly conditioned correlation matrix, and errors in the analysis may
result in the plot failing.</p>
<p>There are two options regarding the palette, the name of the
<a href='https://rdrr.io/pkg/scico/man/scico.html'>scico</a> palette and the direction, in case you want to flip the
color scheme.  Typically, you'll want to use a diverging palette such as vik
or cork.  If you have all positive (or rarely, negative), you might
consider the sequential ones like bilbao or oslo. The lower or upper limit
of the color bar will change accordingly.</p>
<p>I'm normally against 3-d images as they really don't apply in many cases
where they are used, but I think it can actually assist in seeing factor
structure here.</p>
    <h2 class="hasAnchor" id="note"><a class="anchor" href="#note"></a>Note</h2>

    <p>This function essentially assumes a <em>complete</em> correlation matrix like that
returned from <a href='https://rdrr.io/r/stats/cor.html'>cor</a>, and one which should have row/column
names. With <code>plot_only = TRUE</code>, you may potentially supply any matrix,
as the factor analysis will not be done.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p><a href='https://rdrr.io/pkg/scico/man/scico.html'>scico</a>, <a href='https://rdrr.io/pkg/plotly/man/plotly.html'>plotly</a>, <a href='https://rdrr.io/pkg/psych/man/fa.html'>fa</a></p></div>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'>if</span> <span class='op'>(</span><span class='cn'>FALSE</span><span class='op'>)</span> <span class='op'>{</span>
<span class='co'># not run due to package dependencies noted above. make sure to install them.</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://github.com/m-clark/visibly'>visibly</a></span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/data.html'>data</a></span><span class='op'>(</span><span class='st'>'bfi'</span><span class='op'>)</span>
<span class='fu'>corr_heat</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>bfi</span>, use<span class='op'>=</span><span class='st'>'pair'</span><span class='op'>)</span>, diagonal <span class='op'>=</span> <span class='cn'>NA</span>, pal <span class='op'>=</span> <span class='st'>'broc'</span><span class='op'>)</span>
<span class='fu'>corr_heat</span><span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>bfi</span>, use<span class='op'>=</span><span class='st'>'pair'</span><span class='op'>)</span>, diagonal <span class='op'>=</span> <span class='cn'>NA</span>, pal <span class='op'>=</span> <span class='st'>'broc'</span>, dir<span class='op'>=</span><span class='fl'>1</span><span class='op'>)</span>
<span class='fu'>corr_heat</span><span class='op'>(</span><span class='fu'>psych</span><span class='fu'>::</span><span class='va'>Harman23.cor</span><span class='op'>$</span><span class='va'>cov</span>, n_factors <span class='op'>=</span> <span class='fl'>2</span>, pal <span class='op'>=</span> <span class='st'>'oslo'</span><span class='op'>)</span>
<span class='fu'>corr_heat</span><span class='op'>(</span>cormat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span><span class='op'>)</span>
<span class='fu'>corr_heat</span><span class='op'>(</span>cormat <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/stats/cor.html'>cor</a></span><span class='op'>(</span><span class='va'>mtcars</span><span class='op'>)</span>, ordering <span class='op'>=</span> <span class='st'>'polar'</span>, three_d<span class='op'>=</span><span class='cn'>TRUE</span><span class='op'>)</span>
<span class='op'>}</span>

</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by <a href='https://m-clark.github.io'><img src="man/figures/mc_logo.png" width=10% style='display:inline'/></a>.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


